<!-- ============================================
     GROUP COMPONENT
     ============================================
     
     Displays group details with:
     - Group name and description
     - Creation date
     - Member count
     - WhatsApp group link (if available)
     - Action buttons (Add Member, Edit, Delete)
     - Only admins see Edit/Delete buttons
     
     Includes modals for:
     - Add member
     - Edit group (with WhatsApp URL)
     - Delete group confirmation
============================================ -->

<div class="group-card" id="group-card" data-group-id="<%= group.id %>">
    
    <!-- Group Details Display -->
    <div class="group-details">
        
        <div class="detail-row">
            <span class="detail-label">Group Name</span>
            <span class="detail-value"><%= group.name %></span>
        </div>
        
        <div class="detail-row">
            <span class="detail-label">Description</span>
            <span class="detail-value detail-description">
                <%= group.description || 'No description provided' %>
            </span>
        </div>
        
        <% if (group.whatsappGroupUrl) { %>
        <div class="detail-row">
            <span class="detail-label">WhatsApp Group</span>
            <span class="detail-value">
                <a href="<%= group.whatsappGroupUrl %>" 
                   target="_blank" 
                   rel="noopener noreferrer"
                   class="whatsapp-link">
                    üí¨ Open WhatsApp Group
                </a>
            </span>
        </div>
        <% } %>
        
        <div class="detail-row">
            <span class="detail-label">Created</span>
            <span class="detail-value">
                <%= new Date(group.createdAt).toLocaleDateString() %>
            </span>
        </div>
        
        <div class="detail-row">
            <span class="detail-label">Members</span>
            <span class="detail-value"><%= members.length %> member<%= members.length !== 1 ? 's' : '' %></span>
        </div>
        
    </div>
    
    <!-- Action Buttons -->
    <div class="group-actions">
        
        <!-- Add Member (all members can do this) -->
        <button id="add-member-btn" class="btn btn-primary btn-block" type="button">
            ‚ûï Add Member
        </button>
        
        <!-- Admin-only buttons -->
        <% if (currentMember && currentMember.isAdmin) { %>
            <button id="edit-group-btn" class="btn btn-secondary btn-block" type="button">
                ‚úèÔ∏è Edit Group
            </button>
            <button id="delete-group-btn" class="btn btn-danger btn-block" type="button">
                üóëÔ∏è Delete Group
            </button>
        <% } %>
        
    </div>
    
</div>

<!-- ============================================
     ADD MEMBER MODAL
============================================ -->
<div id="add-member-modal" class="modal hidden">
    <div class="modal-overlay"></div>
    <div class="modal-content">
        <div class="modal-header">
            <h3>Add Member to Group</h3>
            <button class="modal-close" type="button">&times;</button>
        </div>
        <div class="modal-body">
            <p class="modal-instruction">Enter the username of the person you want to add:</p>
            <form id="add-member-form">
                <div class="form-group">
                    <label for="member-username">Username *</label>
                    <input 
                        type="text" 
                        id="member-username" 
                        name="username"
                        class="form-input"
                        placeholder="Enter username"
                        required
                        autofocus
                    >
                    <small class="form-error" id="member-username-error"></small>
                </div>
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" data-close-modal="add-member-modal" type="button">
                Cancel
            </button>
            <button id="add-member-submit-btn" class="btn btn-primary" type="button">
                Add Member
            </button>
        </div>
    </div>
</div>

<!-- ============================================
     EDIT GROUP MODAL (Admin Only)
============================================ -->
<% if (currentMember && currentMember.isAdmin) { %>
<div id="edit-group-modal" class="modal hidden">
    <div class="modal-overlay"></div>
    <div class="modal-content">
        <div class="modal-header">
            <h3>Edit Group</h3>
            <button class="modal-close" type="button">&times;</button>
        </div>
        <div class="modal-body">
            <form id="edit-group-form">
                
                <!-- Group Name -->
                <div class="form-group">
                    <label for="edit-group-name">Group Name *</label>
                    <input 
                        type="text" 
                        id="edit-group-name" 
                        name="name"
                        class="form-input"
                        value="<%= group.name %>"
                        required
                        minlength="3"
                        maxlength="50"
                    >
                    <small class="form-hint">3-50 characters</small>
                    <small class="form-error" id="group-name-error"></small>
                </div>
                
                <!-- Group Description -->
                <div class="form-group">
                    <label for="edit-group-description">Description</label>
                    <textarea 
                        id="edit-group-description" 
                        name="description"
                        class="form-input"
                        rows="3"
                        maxlength="200"
                    ><%= group.description || '' %></textarea>
                    <small class="form-hint">Optional, maximum 200 characters</small>
                </div>
                
                <!-- WhatsApp Group URL -->
                <div class="form-group">
                    <label for="edit-whatsapp-url">WhatsApp Group Link</label>
                    <input 
                        type="url" 
                        id="edit-whatsapp-url" 
                        name="whatsappGroupUrl"
                        class="form-input"
                        value="<%= group.whatsappGroupUrl || '' %>"
                        placeholder="https://chat.whatsapp.com/..."
                    >
                    <small class="form-hint">Optional - Paste your WhatsApp group invite link</small>
                    <small class="form-error" id="whatsapp-url-error"></small>
                </div>
                
            </form>
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" data-close-modal="edit-group-modal" type="button">
                Cancel
            </button>
            <button id="save-group-btn" class="btn btn-primary" type="button">
                Save Changes
            </button>
        </div>
    </div>
</div>

<!-- ============================================
     DELETE GROUP CONFIRMATION MODAL (Admin Only)
============================================ -->
<div id="delete-group-modal" class="modal hidden">
    <div class="modal-overlay"></div>
    <div class="modal-content">
        <div class="modal-header">
            <h3>Delete Group</h3>
            <button class="modal-close" type="button">&times;</button>
        </div>
        <div class="modal-body">
            <p class="warning-text">
                ‚ö†Ô∏è <strong>Warning:</strong> This action cannot be undone. 
                Deleting this group will permanently remove:
            </p>
            <ul class="warning-list">
                <li>All group members</li>
                <li>All tasks and assignments</li>
                <li>All expenses and contributions</li>
                <li>The group itself</li>
            </ul>
            <p class="confirmation-prompt">
                Type <strong>"DELETE"</strong> to confirm:
            </p>
            <input 
                type="text" 
                id="delete-group-confirmation-input" 
                class="form-input"
                placeholder="Type DELETE to confirm"
                autocomplete="off"
            >
        </div>
        <div class="modal-footer">
            <button class="btn btn-secondary" data-close-modal="delete-group-modal" type="button">
                Cancel
            </button>
            <button id="confirm-delete-group-btn" class="btn btn-danger" type="button" disabled>
                Delete Group
            </button>
        </div>
    </div>
</div>
<% } %>

<!-- Component-specific JavaScript -->
<script src="/js/components/group-component.js"></script>